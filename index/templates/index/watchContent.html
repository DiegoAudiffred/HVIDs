{% extends 'layout/layout.html' %}
{% load static %}
{% block body %}

<style>
    .media-container {
        position: relative;
        width: 100%;
        padding-top: 56.25%; /* 16:9 aspect ratio */
        overflow: hidden;
        margin-bottom: 20px;
    }

    .media-container iframe,
    .media-container video,
    .media-container img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .custom-controls {
        text-align: center;
        margin-top: 10px;
    }

    .custom-controls button {
        margin: 0 5px;
    }
</style>

<div class="container">
    <h1>{{ mediafile.title }}</h1>
    <p>{{ mediafile.description }}</p>

    <div class="media-container">
        {% if drive_preview_url %}
            <!-- Utilizar iframe para videos de Google Drive -->
            <iframe src="{{ drive_preview_url }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        {% elif mediafile.file|lower|slice:"-3:" == "mp4" %}
            <video id="videoPlayer" controls>
                <source src="{{ mediafile.file }}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        {% else %}
            <img src="{{ mediafile.file }}" alt="{{ mediafile.title }}">
        {% endif %}
    </div>

    {% if mediafile.file|lower|slice:"-3:" == "mp4" %}
    <!-- Controles personalizados para adelantar o retroceder video -->
    <div class="custom-controls">
        <button onclick="seekVideo(-10)" class="btn btn-secondary">Retroceder 10s</button>
        <button onclick="seekVideo(10)" class="btn btn-secondary">Adelantar 10s</button>
    </div>
    {% endif %}

    <p><strong>Uploaded At:</strong> {{ mediafile.uploaded_at }}</p>
    <p><strong>Tags:</strong>
        {% for tag in mediafile.tags.all %}
            <span class="badge bg-secondary">{{ tag.name }}</span>
        {% endfor %}
    </p>

    <a href="{{ mediafile.file }}" class="btn btn-primary" download>Download</a>
</div>

<script>
    function seekVideo(seconds) {
        var video = document.getElementById('videoPlayer');
        if (video) {
            video.currentTime += seconds;
        }
    }
</script>

{% endblock %}
